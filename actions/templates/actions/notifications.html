{% extends "main/base.html" %}
{% load static %}
{% load thumbnail %}

{% block title %}
    Powiadomienia
{% endblock title %}

{% block header %}
    <div class="row justify-content-center m-4 mt-5">
        <h2 class="m-0 font-weight-bolder">
            Powiadomienia
        </h2>
    </div>
    <div class="row mb-2 d-flex justify-content-center">
        <hr class="hr hr-bold bg-accent-color w-75" />
    </div>
{% endblock header %}
    
{% block content %}

<div class="d-flex flex-column align-items-center mb-2">
    {% if actions %}    
        {% for action in actions %}
            {% with action.user as user %}
                <div class="d-flex rounded main-shadow-box my-2 w-50 bg-secondary-color justify-content-evenly">
                    <div class="d-flex justify-content-center align-items-center m-3">
                        <a href="{% url 'user_profile' user.username %}" class="d-flex align-items-start">
                            <div class="d-flex profile-pic-small bg-gentle-color rounded border border-black border-2 accent-shadow-box">
                                {% thumbnail user.profile.image "90x90" crop="true" as im %}
                                <img src="{% if im %}{{ im.url }}{% else %}{% static 'profile_images/no_image.png' %}{% endif %}"
                                    class="img-fluid {% if im %}p-0{% else %}p-1{% endif %} rounded-1">
                            </div>    
                        </a>
                    </div>

                    <div class="d-flex flex-column justify-content-evenly align-items-start my-1 w-75">
                        <div>
                            <a href="{% url 'user_profile' user.username %}"> {{ user.username }}</a>
                            {{ action.verb }}
                            {% if action.verb != 'oznacza Cię w swoim poście.' %}
                                <a href="{{ action.target.get_absolute_url }}">{{ action.target }}</a>
                            {% endif %}
                        </div>

                        <span class="small-font subtle-color fst-italic m-1">
                            {{ action.created|timesince }} temu
                        </span>
                    </div>

                    <div class="d-flex m-3">
                        {% if action.target.image %}
                            <a href="{{ action.target.get_absolute_url }}">
                                <img src="{{ action.target.image }}" 
                                class="notification-post-image">
                            </a>
                        {% endif %}
                    </div>
                </div> 
            {% endwith %}
        {% endfor %}
    {% else %}
    <div class="w-75 mt-4">
        <p>Skrzynka Twoich powiadomień jest jeszcze pusta.</p>

        <p class="subtle-color">
            <a href="#" class="fw-bolder">Dodaj nowy post</a>, oznacz znajomych, a poprzez tagi opisz jakie emocje opisuje wybrana przez Ciebie piosenka.
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="accent-color bi bi-hearts" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.931.481c1.627-1.671 5.692 1.254 0 5.015-5.692-3.76-1.626-6.686 0-5.015Zm6.84 1.794c1.084-1.114 3.795.836 0 3.343-3.795-2.507-1.084-4.457 0-3.343ZM7.84 7.642c2.71-2.786 9.486 2.09 0 8.358-9.487-6.268-2.71-11.144 0-8.358Z"/>
            </svg>
        </p>
    </div>
    {% endif %}
</div>

{% endblock content %}
